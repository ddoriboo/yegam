# Yegam (ì˜ˆê²œ) ì„œë¹„ìŠ¤ ì¢…í•© ê¸°ìˆ  ë¬¸ì„œ

## ğŸ“‹ ëª©ì°¨
1. [ì„œë¹„ìŠ¤ ê°œìš”](#ì„œë¹„ìŠ¤-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
4. [ë² íŒ… ë©”ì¹´ë‹ˆì¦˜ ë° í”Œë¡œìš°](#ë² íŒ…-ë©”ì¹´ë‹ˆì¦˜-ë°-í”Œë¡œìš°)
5. [API ì—”ë“œí¬ì¸íŠ¸](#api-ì—”ë“œí¬ì¸íŠ¸)
6. [í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°](#í”„ë¡ íŠ¸ì—”ë“œ-êµ¬ì¡°)
7. [ì¸ì¦ ë° ë³´ì•ˆ](#ì¸ì¦-ë°-ë³´ì•ˆ)
8. [ë°°í¬ ë° ìš´ì˜](#ë°°í¬-ë°-ìš´ì˜)
9. [ê°œë°œ íˆìŠ¤í† ë¦¬](#ê°œë°œ-íˆìŠ¤í† ë¦¬)
10. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…-ê°€ì´ë“œ)

---

## ğŸ“– ì„œë¹„ìŠ¤ ê°œìš”

### ğŸ’¡ Yegamì´ë€?
**Yegam(ì˜ˆê²œ)**ì€ í•œêµ­ì–´ ì˜ˆì¸¡ ì‹œì¥ í”Œë«í¼ìœ¼ë¡œ, ì‚¬ìš©ìë“¤ì´ ë‹¤ì–‘í•œ ì´ìŠˆì— ëŒ€í•´ ì˜ˆì¸¡í•˜ê³  ê°€ìƒ í™”íì¸ **"ê°(GAM)"**ì„ ì´ìš©í•´ ì°¸ì—¬í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ ê°€ì¹˜ ì œì•ˆ
- **ì‹¤ì‹œê°„ ì˜ˆì¸¡ ì‹œì¥**: ë‹¤ì–‘í•œ ì¹´í…Œê³ ë¦¬ì˜ ì´ìŠˆì— ëŒ€í•œ Yes/No ì˜ˆì¸¡
- **GAM ê²½ì œ ì‹œìŠ¤í…œ**: ê°€ìƒ í™”íë¥¼ í†µí•œ ì•ˆì „í•œ ì˜ˆì¸¡ ì°¸ì—¬
- **ì»¤ë®¤ë‹ˆí‹° ê¸°ë°˜**: ëŒ“ê¸€, í† ë¡ ì„ í†µí•œ ì§‘ë‹¨ ì§€ì„± í™œìš©
- **íˆ¬ëª…í•œ í™•ë¥  ì‹œìŠ¤í…œ**: ë² íŒ… í˜„í™©ì— ë”°ë¥¸ ì‹¤ì‹œê°„ í™•ë¥  ì—…ë°ì´íŠ¸

### ğŸ·ï¸ ì£¼ìš” ì¹´í…Œê³ ë¦¬ (8ê°œ)
| ì¹´í…Œê³ ë¦¬ | ì„¤ëª… | ìƒ‰ìƒ í…Œë§ˆ |
|---------|------|-----------|
| ì •ì¹˜ | ì„ ê±°, ì •ì±…, ì •ì¹˜ì  ì´ë²¤íŠ¸ | ë¹¨ê°„ìƒ‰ ê·¸ë¼ë°ì´ì…˜ |
| ìŠ¤í¬ì¸  | ê²½ê¸° ê²°ê³¼, ì‹œì¦Œ ì„±ê³¼ | ì²­ë¡ìƒ‰ ê·¸ë¼ë°ì´ì…˜ |
| ê²½ì œ | ì£¼ì‹, í™˜ìœ¨, ê²½ì œ ì§€í‘œ | ì´ˆë¡ìƒ‰ ê·¸ë¼ë°ì´ì…˜ |
| ì½”ì¸ | ì•”í˜¸í™”í ê°€ê²©, íŠ¸ë Œë“œ | ë…¸ë€ìƒ‰ ê·¸ë¼ë°ì´ì…˜ |
| í…Œí¬ | ê¸°ìˆ  íŠ¸ë Œë“œ, ì œí’ˆ ì¶œì‹œ | ë³´ë¼ìƒ‰ ê·¸ë¼ë°ì´ì…˜ |
| ì—”í„° | ì—°ì˜ˆê³„, ë¬¸í™” ì½˜í…ì¸  | í•‘í¬ìƒ‰ ê·¸ë¼ë°ì´ì…˜ |
| ë‚ ì”¨ | ê¸°ìƒ ì˜ˆë³´, ê³„ì ˆ ì˜ˆì¸¡ | íŒŒë€ìƒ‰ ê·¸ë¼ë°ì´ì…˜ |
| í•´ì™¸ | êµ­ì œ ì •ì¹˜, ê¸€ë¡œë²Œ ì´ë²¤íŠ¸ | ì¸ë””ê³  ê·¸ë¼ë°ì´ì…˜ |

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

#### Frontend
```
HTML5/CSS3
â”œâ”€â”€ Semantic Markup
â”œâ”€â”€ Modern CSS (Grid, Flexbox)
â”œâ”€â”€ Glassmorphism Design
â””â”€â”€ Responsive Web Design

JavaScript (ES6+)
â”œâ”€â”€ Vanilla JavaScript
â”œâ”€â”€ Async/Await Patterns
â”œâ”€â”€ Module System
â”œâ”€â”€ DOM Manipulation
â””â”€â”€ LocalStorage Management

UI Framework
â”œâ”€â”€ Tailwind CSS (Utility-First)
â”œâ”€â”€ Lucide Icons
â””â”€â”€ Custom CSS Components
```

#### Backend
```
Node.js + Express
â”œâ”€â”€ RESTful API Design
â”œâ”€â”€ Middleware Architecture
â”œâ”€â”€ Error Handling
â””â”€â”€ Request Validation

Database
â”œâ”€â”€ PostgreSQL (Production)
â”œâ”€â”€ Connection Pooling
â”œâ”€â”€ Query Optimization
â””â”€â”€ Data Integrity

Authentication
â”œâ”€â”€ JWT (JSON Web Tokens)
â”œâ”€â”€ bcryptjs (Password Hashing)
â”œâ”€â”€ Session Management
â””â”€â”€ Rate Limiting

External Services
â”œâ”€â”€ Cloudinary (Image Storage)
â”œâ”€â”€ Railway (Hosting Platform)
â””â”€â”€ Health Check System
```

### ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
yegam/
â”œâ”€â”€ ğŸ“„ HTML Pages
â”‚   â”œâ”€â”€ index.html              # ë©”ì¸ í˜ì´ì§€
â”‚   â”œâ”€â”€ login.html              # ë¡œê·¸ì¸/íšŒì›ê°€ì…
â”‚   â”œâ”€â”€ issues.html             # ì „ì²´ ì´ìŠˆ ëª©ë¡
â”‚   â”œâ”€â”€ mypage.html             # ë§ˆì´í˜ì´ì§€
â”‚   â”œâ”€â”€ admin.html              # ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ
â”‚   â”œâ”€â”€ admin-login.html        # ê´€ë¦¬ì ë¡œê·¸ì¸
â”‚   â””â”€â”€ tier_guide.html         # í‹°ì–´ ê°€ì´ë“œ
â”‚
â”œâ”€â”€ ğŸ¨ Frontend Assets
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css           # ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ app.js              # ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§
â”‚       â”œâ”€â”€ auth.js             # ì¸ì¦ ì‹œìŠ¤í…œ
â”‚       â”œâ”€â”€ backend.js          # ë°±ì—”ë“œ ì¸í„°í˜ì´ìŠ¤
â”‚       â””â”€â”€ data.js             # ì´ˆê¸° ë°ì´í„°
â”‚
â”œâ”€â”€ ğŸ”§ Backend Core
â”‚   â”œâ”€â”€ server.js               # Express ì„œë²„ ì§„ì…ì 
â”‚   â”œâ”€â”€ middleware/             # ë¯¸ë“¤ì›¨ì–´ ëª¨ìŒ
â”‚   â”‚   â”œâ”€â”€ auth.js             # ì‚¬ìš©ì ì¸ì¦
â”‚   â”‚   â”œâ”€â”€ admin-auth-secure.js # ê´€ë¦¬ì ì¸ì¦
â”‚   â”‚   â”œâ”€â”€ validation.js       # ì…ë ¥ê°’ ê²€ì¦
â”‚   â”‚   â””â”€â”€ error-handler.js    # ì—ëŸ¬ ì²˜ë¦¬
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/                 # API ë¼ìš°íŠ¸
â”‚   â”‚   â”œâ”€â”€ auth.js             # ì‚¬ìš©ì ì¸ì¦ API
â”‚   â”‚   â”œâ”€â”€ admin-auth-secure.js # ê´€ë¦¬ì ì¸ì¦ API
â”‚   â”‚   â”œâ”€â”€ issues.js           # ì´ìŠˆ ê´€ë¦¬ API
â”‚   â”‚   â”œâ”€â”€ bets.js             # ë² íŒ… API
â”‚   â”‚   â”œâ”€â”€ comments.js         # ëŒ“ê¸€ API
â”‚   â”‚   â”œâ”€â”€ notifications.js    # ì•Œë¦¼ API
â”‚   â”‚   â”œâ”€â”€ gam.js              # GAM ê±°ë˜ API
â”‚   â”‚   â””â”€â”€ upload.js           # íŒŒì¼ ì—…ë¡œë“œ API
â”‚   â”‚
â”‚   â”œâ”€â”€ database/               # ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ database.js         # DB ì—°ê²° ë° ì¿¼ë¦¬ í—¬í¼
â”‚   â”‚   â”œâ”€â”€ postgres.js         # PostgreSQL ì„¤ì •
â”‚   â”‚   â””â”€â”€ admin-schema.sql    # ê´€ë¦¬ì í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ services/               # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ gamService.js       # GAM ê²½ì œ ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ issueScheduler.js   # ì´ìŠˆ ìë™ ë§ˆê°
â”‚   â”‚   â””â”€â”€ notificationService.js # ì•Œë¦¼ ì„œë¹„ìŠ¤
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                  # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â”œâ”€â”€ health-check.js     # ì„œë²„ ìƒíƒœ ì ê²€
â”‚   â”‚   â””â”€â”€ validators.js       # ì…ë ¥ê°’ ê²€ì¦
â”‚   â”‚
â”‚   â””â”€â”€ config/                 # ì„¤ì • íŒŒì¼
â”‚       â”œâ”€â”€ constants.js        # ìƒìˆ˜ ì •ì˜
â”‚       â””â”€â”€ env.js              # í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
â”‚
â”œâ”€â”€ ğŸ“Š DevOps & Config
â”‚   â”œâ”€â”€ package.json            # Node.js ì˜ì¡´ì„±
â”‚   â”œâ”€â”€ railway.toml            # Railway ë°°í¬ ì„¤ì •
â”‚   â”œâ”€â”€ .env.example            # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”‚   â”œâ”€â”€ .gitignore              # Git ì œì™¸ íŒŒì¼
â”‚   â””â”€â”€ README.md               # í”„ë¡œì íŠ¸ ì„¤ëª…ì„œ
â”‚
â””â”€â”€ ğŸ› ï¸ Scripts
    â””â”€â”€ scripts/
        â””â”€â”€ create-admin.js     # ê´€ë¦¬ì ê³„ì • ìƒì„± ìŠ¤í¬ë¦½íŠ¸
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### ğŸ“Š ERD (Entity Relationship Diagram)

```mermaid
erDiagram
    USERS ||--o{ BETS : "places"
    USERS ||--o{ COMMENTS : "writes"
    USERS ||--o{ NOTIFICATIONS : "receives"
    USERS ||--o{ GAM_TRANSACTIONS : "performs"
    USERS ||--o{ REWARDS : "receives"
    ISSUES ||--o{ BETS : "has"
    ISSUES ||--o{ COMMENTS : "has"
    ISSUES ||--o{ REWARDS : "generates"
    COMMENTS ||--o{ COMMENTS : "replies_to"
    BETS ||--o{ REWARDS : "generates"

    USERS {
        int id PK
        string username UK
        string email UK
        string password_hash
        int gam_balance
        int correct_predictions
        timestamp created_at
        timestamp updated_at
    }

    ISSUES {
        int id PK
        string title
        text description
        string category
        string status
        timestamp end_date
        string result
        string image_url
        int yes_volume
        int no_volume
        int decided_by FK
        timestamp decided_at
        text decision_reason
        timestamp created_at
        timestamp updated_at
    }

    BETS {
        int id PK
        int user_id FK
        int issue_id FK
        string choice
        int amount
        timestamp created_at
    }

    COMMENTS {
        int id PK
        int user_id FK
        int issue_id FK
        int parent_id FK
        text content
        int likes
        int dislikes
        boolean is_hidden
        timestamp created_at
        timestamp updated_at
    }

    NOTIFICATIONS {
        int id PK
        int user_id FK
        string type
        string title
        text message
        int related_id
        string related_type
        boolean is_read
        timestamp created_at
    }

    GAM_TRANSACTIONS {
        int id PK
        int user_id FK
        string type
        string category
        int amount
        text description
        int reference_id
        timestamp created_at
    }

    REWARDS {
        int id PK
        int user_id FK
        int issue_id FK
        int bet_id FK
        int reward_amount
        timestamp created_at
    }

    ADMINS {
        int id PK
        string username UK
        string email UK
        string password_hash
        string full_name
        string role
        boolean is_active
        timestamp last_login
        timestamp created_at
        timestamp updated_at
    }

    ADMIN_SESSIONS {
        int id PK
        int admin_id FK
        string token_hash UK
        timestamp expires_at
        string ip_address
        string user_agent
        boolean is_active
        timestamp created_at
    }

    ADMIN_ACTIVITY_LOGS {
        int id PK
        int admin_id FK
        string action
        string resource_type
        int resource_id
        jsonb details
        string ip_address
        string user_agent
        timestamp created_at
    }
```

### ğŸ·ï¸ í…Œì´ë¸”ë³„ ìƒì„¸ ì •ì˜

#### ğŸ‘¥ Users (ì‚¬ìš©ì)
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    gam_balance INTEGER DEFAULT 10000,  -- ì´ˆê¸° GAM: 10,000
    correct_predictions INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**ì»¬ëŸ¼ ì„¤ëª…:**
- `gam_balance`: ì‚¬ìš©ìì˜ GAM ì”ì•¡ (ê°€ìƒ í™”í)
- `correct_predictions`: ë§ì¶˜ ì˜ˆì¸¡ íšŸìˆ˜ (ì„±ì·¨ ì‹œìŠ¤í…œìš©)

#### ğŸ“‹ Issues (ì´ìŠˆ)
```sql
CREATE TABLE issues (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    category VARCHAR(50) NOT NULL,
    status VARCHAR(20) DEFAULT 'active',  -- active, closed, settled
    end_date TIMESTAMP NOT NULL,
    result VARCHAR(10) DEFAULT NULL,      -- Yes, No, NULL
    image_url TEXT,
    yes_volume INTEGER DEFAULT 0,
    no_volume INTEGER DEFAULT 0,
    decided_by INTEGER REFERENCES users(id),
    decided_at TIMESTAMP DEFAULT NULL,
    decision_reason TEXT DEFAULT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**ìƒíƒœ ì •ì˜:**
- `active`: ë² íŒ… ê°€ëŠ¥í•œ í™œì„± ì´ìŠˆ
- `closed`: ë§ˆê°ëœ ì´ìŠˆ (ê²°ê³¼ ëŒ€ê¸°)
- `settled`: ì •ì‚° ì™„ë£Œëœ ì´ìŠˆ

#### ğŸ² Bets (ë² íŒ…)
```sql
CREATE TABLE bets (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id),
    issue_id INTEGER NOT NULL REFERENCES issues(id),
    choice VARCHAR(10) NOT NULL,  -- Yes, No
    amount INTEGER NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(user_id, issue_id)  -- í•œ ì´ìŠˆë‹¹ í•œ ë²ˆë§Œ ë² íŒ… ê°€ëŠ¥
);
```

#### ğŸ’¬ Comments (ëŒ“ê¸€)
```sql
CREATE TABLE comments (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id),
    issue_id INTEGER NOT NULL REFERENCES issues(id),
    parent_id INTEGER REFERENCES comments(id),  -- ëŒ€ëŒ“ê¸€ ì§€ì›
    content TEXT NOT NULL,
    likes INTEGER DEFAULT 0,
    dislikes INTEGER DEFAULT 0,
    is_hidden BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ğŸ’° GAM_Transactions (GAM ê±°ë˜ ë‚´ì—­)
```sql
CREATE TABLE gam_transactions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    type VARCHAR(20) NOT NULL CHECK (type IN ('earn', 'burn')),
    category VARCHAR(50) NOT NULL,
    amount INTEGER NOT NULL,
    description TEXT,
    reference_id INTEGER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**ê±°ë˜ íƒ€ì…:**
- `earn`: GAM íšë“ (íšŒì›ê°€ì…, ë² íŒ… ìŠ¹ë¦¬, ëŒ“ê¸€ ì‘ì„± ë“±)
- `burn`: GAM ì†Œëª¨ (ë² íŒ…, ìˆ˜ìˆ˜ë£Œ ë“±)

**ê±°ë˜ ì¹´í…Œê³ ë¦¬:**
- `signup`: íšŒì›ê°€ì… ë³´ë„ˆìŠ¤
- `betting_win`: ë² íŒ… ìŠ¹ë¦¬
- `betting_loss`: ë² íŒ… ì°¸ì—¬ (ì°¨ê°)
- `commission`: ìˆ˜ìˆ˜ë£Œ
- `comment_reward`: ëŒ“ê¸€ ì‘ì„± ë³´ìƒ

#### ğŸ” ê´€ë¦¬ì í…Œì´ë¸”ë“¤

**Admins (ê´€ë¦¬ì)**
```sql
CREATE TABLE admins (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100),
    role VARCHAR(20) DEFAULT 'admin',  -- admin, super_admin
    is_active BOOLEAN DEFAULT true,
    last_login TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**Admin_Sessions (ê´€ë¦¬ì ì„¸ì…˜)**
```sql
CREATE TABLE admin_sessions (
    id SERIAL PRIMARY KEY,
    admin_id INTEGER REFERENCES admins(id) ON DELETE CASCADE,
    token_hash VARCHAR(255) UNIQUE NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    ip_address INET,
    user_agent TEXT,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## ğŸ¯ ë² íŒ… ë©”ì¹´ë‹ˆì¦˜ ë° í”Œë¡œìš°

### ğŸ”„ ì „ì²´ ë² íŒ… í”Œë¡œìš°

```mermaid
graph TD
    A[ì‚¬ìš©ì ì´ìŠˆ ì„ íƒ] --> B{ë¡œê·¸ì¸ í™•ì¸}
    B -->|ë¯¸ë¡œê·¸ì¸| C[ë¡œê·¸ì¸ í˜ì´ì§€ ì´ë™]
    B -->|ë¡œê·¸ì¸ë¨| D[ë² íŒ… í˜ì´ì§€ ì§„ì…]
    
    D --> E[ë² íŒ… ì„ íƒ - Yes/No]
    E --> F[ë² íŒ… ê¸ˆì•¡ ì…ë ¥]
    F --> G{GAM ì”ì•¡ í™•ì¸}
    
    G -->|ë¶€ì¡±| H[ì”ì•¡ ë¶€ì¡± ì—ëŸ¬]
    G -->|ì¶©ë¶„| I[ë² íŒ… ì‹¤í–‰]
    
    I --> J[GAM ì°¨ê°]
    J --> K[ë² íŒ… ê¸°ë¡ ì €ì¥]
    K --> L[ì´ìŠˆ ë³¼ë¥¨ ì—…ë°ì´íŠ¸]
    L --> M[í™•ë¥  ì¬ê³„ì‚°]
    M --> N[ì‹¤ì‹œê°„ UI ì—…ë°ì´íŠ¸]
    
    N --> O{ì´ìŠˆ ë§ˆê° ì‹œì }
    O -->|ì§„í–‰ì¤‘| P[ëŒ€ê¸°]
    O -->|ë§ˆê°| Q[ê´€ë¦¬ì ê²°ê³¼ ê²°ì •]
    
    Q --> R{ë² íŒ… ê²°ê³¼}
    R -->|ìŠ¹ë¦¬| S[ìˆ˜ìµ ê³„ì‚° ë° ì§€ê¸‰]
    R -->|íŒ¨ë°°| T[ì†ì‹¤ í™•ì •]
    
    S --> U[GAM ì§€ê¸‰]
    U --> V[ìˆ˜ìˆ˜ë£Œ ì°¨ê° - 2%]
    V --> W[ì•Œë¦¼ ì „ì†¡]
    
    T --> W
    W --> X[ì •ì‚° ì™„ë£Œ]
```

### ğŸ’¡ í™•ë¥  ê³„ì‚° ì•Œê³ ë¦¬ì¦˜

**ì‹¤ì‹œê°„ í™•ë¥  ê³„ì‚°:**
```javascript
// ë² íŒ… ë³¼ë¥¨ ê¸°ë°˜ í™•ë¥  ê³„ì‚°
const calculateProbability = (yesVolume, noVolume) => {
    const totalVolume = yesVolume + noVolume;
    if (totalVolume === 0) {
        return { yes: 50, no: 50 }; // ê¸°ë³¸ê°’
    }
    
    const yesPercentage = Math.round((yesVolume / totalVolume) * 100);
    const noPercentage = 100 - yesPercentage;
    
    return {
        yes: yesPercentage,
        no: noPercentage
    };
};
```

### ğŸ’° ìˆ˜ìµ ê³„ì‚° ì‹œìŠ¤í…œ

**ë² íŒ… ìˆ˜ìµ ê³µì‹:**
```javascript
// ìŠ¹ë¦¬ ì‹œ ìˆ˜ìµ ê³„ì‚°
const calculateWinnings = (userBet, winnerVolume, loserVolume) => {
    // ìŠ¹ë¦¬ ë¹„ìœ¨ ê³„ì‚°
    const winRatio = userBet.amount / winnerVolume;
    
    // ìˆ˜ìµ = íŒ¨ë°°ì ë³¼ë¥¨ Ã— ìŠ¹ë¦¬ ë¹„ìœ¨
    const profit = Math.floor(loserVolume * winRatio);
    
    // ì´ íšë“ì•¡ = ì›ê¸ˆ + ìˆ˜ìµ
    const totalWinAmount = userBet.amount + profit;
    
    // ìˆ˜ìˆ˜ë£Œ ê³„ì‚° (2%)
    const commission = Math.floor(totalWinAmount * 0.02);
    
    // ìµœì¢… ì§€ê¸‰ì•¡
    const finalAmount = totalWinAmount - commission;
    
    return {
        originalBet: userBet.amount,
        profit: profit,
        commission: commission,
        finalAmount: finalAmount
    };
};
```

### ğŸ”’ ë² íŒ… ì œì•½ ì¡°ê±´
1. **ì¤‘ë³µ ë² íŒ… ë°©ì§€**: í•œ ì´ìŠˆë‹¹ í•œ ë²ˆë§Œ ë² íŒ… ê°€ëŠ¥
2. **ìµœì†Œ ê¸ˆì•¡**: 1 GAM ì´ìƒ
3. **ìµœëŒ€ ê¸ˆì•¡**: ë³´ìœ  GAM í•œë„ ë‚´
4. **ì‹œê°„ ì œí•œ**: ì´ìŠˆ ë§ˆê° ì‹œê°„ ì „ê¹Œì§€ë§Œ ê°€ëŠ¥
5. **ê³„ì • ìƒíƒœ**: í™œì„±í™”ëœ ê³„ì •ë§Œ ê°€ëŠ¥

---

## ğŸ› ï¸ API ì—”ë“œí¬ì¸íŠ¸

### ğŸ” ì¸ì¦ API (`/api/auth`)

#### POST `/api/auth/signup`
**íšŒì›ê°€ì…**
```json
// Request
{
    "username": "yegamer123",
    "email": "user@example.com",
    "password": "securePassword123"
}

// Response (Success)
{
    "success": true,
    "message": "íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!",
    "user": {
        "id": 1,
        "username": "yegamer123",
        "email": "user@example.com",
        "gamBalance": 10000
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### POST `/api/auth/login`
**ë¡œê·¸ì¸**
```json
// Request
{
    "email": "user@example.com",
    "password": "securePassword123"
}

// Response (Success)
{
    "success": true,
    "message": "ë¡œê·¸ì¸ ì„±ê³µ",
    "user": {
        "id": 1,
        "username": "yegamer123",
        "gamBalance": 8500
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### GET `/api/auth/verify`
**í† í° ê²€ì¦**
```json
// Headers
{
    "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

// Response (Success)
{
    "success": true,
    "user": {
        "id": 1,
        "username": "yegamer123",
        "gamBalance": 8500
    }
}
```

### ğŸ“‹ ì´ìŠˆ API (`/api/issues`)

#### GET `/api/issues`
**ì´ìŠˆ ëª©ë¡ ì¡°íšŒ**
```json
// Query Parameters (Optional)
// ?category=ì •ì¹˜&status=active&page=1&limit=10

// Response
{
    "success": true,
    "issues": [
        {
            "id": 1,
            "title": "2025ë…„ ìƒë°˜ê¸° ë¹„íŠ¸ì½”ì¸ì´ 10ë§Œ ë‹¬ëŸ¬ë¥¼ ë„˜ì„ê¹Œ?",
            "description": "í˜„ì¬ ë¹„íŠ¸ì½”ì¸ ê°€ê²© ë™í–¥ì„ ê³ ë ¤í•œ ì˜ˆì¸¡",
            "category": "ì½”ì¸",
            "status": "active",
            "endDate": "2025-06-30T23:59:59Z",
            "imageUrl": "https://cloudinary.com/...",
            "yesVolume": 15000,
            "noVolume": 8500,
            "probability": {
                "yes": 64,
                "no": 36
            },
            "createdAt": "2025-01-15T10:00:00Z"
        }
    ],
    "pagination": {
        "currentPage": 1,
        "totalPages": 5,
        "totalIssues": 47,
        "limit": 10
    }
}
```

#### POST `/api/issues`
**ì´ìŠˆ ìƒì„± (ê´€ë¦¬ì)**
```json
// Request
{
    "title": "ìƒˆë¡œìš´ ì˜ˆì¸¡ ì´ìŠˆ",
    "description": "ìƒì„¸ ì„¤ëª…",
    "category": "í…Œí¬",
    "endDate": "2025-12-31T23:59:59Z",
    "imageUrl": "https://cloudinary.com/..."
}

// Response
{
    "success": true,
    "message": "ì´ìŠˆê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
    "issue": {
        "id": 42,
        "title": "ìƒˆë¡œìš´ ì˜ˆì¸¡ ì´ìŠˆ",
        // ... other fields
    }
}
```

### ğŸ² ë² íŒ… API (`/api/bets`)

#### POST `/api/bets`
**ë² íŒ…í•˜ê¸°**
```json
// Request
{
    "issueId": 1,
    "choice": "Yes",
    "amount": 1000
}

// Response (Success)
{
    "success": true,
    "message": "ë² íŒ…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
    "bet": {
        "id": 123,
        "issueId": 1,
        "choice": "Yes",
        "amount": 1000,
        "createdAt": "2025-06-22T10:30:00Z"
    },
    "updatedBalance": 7500,
    "updatedProbability": {
        "yes": 66,
        "no": 34
    }
}
```

#### GET `/api/bets/my-bets`
**ë‚´ ë² íŒ… ë‚´ì—­**
```json
// Response
{
    "success": true,
    "bets": [
        {
            "id": 123,
            "issue": {
                "id": 1,
                "title": "ë¹„íŠ¸ì½”ì¸ 10ë§Œ ë‹¬ëŸ¬ ëŒíŒŒ",
                "category": "ì½”ì¸",
                "status": "active"
            },
            "choice": "Yes",
            "amount": 1000,
            "createdAt": "2025-06-22T10:30:00Z",
            "result": null  // pending, win, lose
        }
    ]
}
```

#### GET `/api/bets/issue/:issueId/stats`
**ì´ìŠˆë³„ ë² íŒ… í†µê³„**
```json
// Response
{
    "success": true,
    "stats": {
        "issueId": 1,
        "totalVolume": 23500,
        "yesVolume": 15000,
        "noVolume": 8500,
        "totalBettors": 47,
        "yesBettors": 28,
        "noBettors": 19,
        "probability": {
            "yes": 64,
            "no": 36
        }
    }
}
```

### ğŸ’¬ ëŒ“ê¸€ API (`/api/comments`)

#### GET `/api/comments/issue/:issueId`
**ì´ìŠˆë³„ ëŒ“ê¸€ ì¡°íšŒ**
```json
// Query: ?page=1&limit=10

// Response
{
    "success": true,
    "comments": [
        {
            "id": 1,
            "user": {
                "id": 5,
                "username": "crypto_expert"
            },
            "content": "ê¸°ìˆ ì  ë¶„ì„ì„ ë³´ë©´ ìƒìŠ¹ ê°€ëŠ¥ì„±ì´ ë†’ì•„ ë³´ì…ë‹ˆë‹¤.",
            "likes": 12,
            "dislikes": 3,
            "replies": [
                {
                    "id": 2,
                    "user": {
                        "id": 7,
                        "username": "skeptic_trader"
                    },
                    "content": "í•˜ì§€ë§Œ ê±°ì‹œê²½ì œ ìƒí™©ì„ ê³ ë ¤í•˜ë©´...",
                    "likes": 5,
                    "dislikes": 1,
                    "createdAt": "2025-06-22T11:00:00Z"
                }
            ],
            "createdAt": "2025-06-22T10:45:00Z"
        }
    ],
    "pagination": {
        "currentPage": 1,
        "totalPages": 3,
        "totalComments": 28
    }
}
```

#### POST `/api/comments`
**ëŒ“ê¸€ ì‘ì„±**
```json
// Request
{
    "issueId": 1,
    "content": "í¥ë¯¸ë¡œìš´ ì˜ˆì¸¡ì´ë„¤ìš”!",
    "parentId": null  // ëŒ€ëŒ“ê¸€ì¸ ê²½ìš° ë¶€ëª¨ ëŒ“ê¸€ ID
}

// Response
{
    "success": true,
    "message": "ëŒ“ê¸€ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
    "comment": {
        "id": 42,
        "content": "í¥ë¯¸ë¡œìš´ ì˜ˆì¸¡ì´ë„¤ìš”!",
        "createdAt": "2025-06-22T12:00:00Z"
    },
    "gamReward": 10  // ëŒ“ê¸€ ì‘ì„± ë³´ìƒ
}
```

### ğŸ’° GAM API (`/api/gam`)

#### GET `/api/gam/balance`
**GAM ì”ì•¡ ì¡°íšŒ**
```json
// Response
{
    "success": true,
    "balance": 8500,
    "user": {
        "id": 1,
        "username": "yegamer123"
    }
}
```

#### GET `/api/gam/transactions`
**GAM ê±°ë˜ ë‚´ì—­**
```json
// Response
{
    "success": true,
    "transactions": [
        {
            "id": 101,
            "type": "burn",
            "category": "betting_loss",
            "amount": 1000,
            "description": "ë² íŒ… ì°¸ì—¬: ë¹„íŠ¸ì½”ì¸ 10ë§Œ ë‹¬ëŸ¬ ëŒíŒŒ",
            "createdAt": "2025-06-22T10:30:00Z"
        },
        {
            "id": 100,
            "type": "earn",
            "category": "comment_reward",
            "amount": 10,
            "description": "ëŒ“ê¸€ ì‘ì„± ë³´ìƒ",
            "createdAt": "2025-06-22T09:15:00Z"
        }
    ]
}
```

### ğŸ”” ì•Œë¦¼ API (`/api/notifications`)

#### GET `/api/notifications`
**ì•Œë¦¼ ëª©ë¡**
```json
// Response
{
    "success": true,
    "notifications": [
        {
            "id": 1,
            "type": "betting_result",
            "title": "ë² íŒ… ê²°ê³¼ ì•Œë¦¼",
            "message": "ë¹„íŠ¸ì½”ì¸ ì˜ˆì¸¡ì´ ì ì¤‘í–ˆìŠµë‹ˆë‹¤! 1,500 GAMì„ íšë“í–ˆìŠµë‹ˆë‹¤.",
            "isRead": false,
            "relatedId": 1,
            "relatedType": "issue",
            "createdAt": "2025-06-22T08:00:00Z"
        }
    ],
    "unreadCount": 3
}
```

### ğŸ›¡ï¸ ê´€ë¦¬ì API (`/api/admin`)

#### POST `/api/admin-auth/login`
**ê´€ë¦¬ì ë¡œê·¸ì¸**
```json
// Request
{
    "username": "superadmin",
    "password": "SecureAdminPass123!"
}

// Response
{
    "success": true,
    "message": "ê´€ë¦¬ì ë¡œê·¸ì¸ ì„±ê³µ",
    "admin": {
        "id": 1,
        "username": "superadmin",
        "role": "super_admin"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

---

## ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¡°

### ğŸ“± í˜ì´ì§€ë³„ ê¸°ëŠ¥

#### ğŸ  ë©”ì¸ í˜ì´ì§€ (`index.html`)
**í•µì‹¬ ê¸°ëŠ¥:**
- ìµœì‹  ì¸ê¸° ì´ìŠˆ í‘œì‹œ (ì¹´í…Œê³ ë¦¬ë³„ í•„í„°ë§)
- ì‹¤ì‹œê°„ í™•ë¥  ê²Œì´ì§€
- ë¹ ë¥¸ ë² íŒ… ì¸í„°í˜ì´ìŠ¤
- íŠ¸ë Œë”© ì´ìŠˆ ì„¹ì…˜

**ì£¼ìš” ì»´í¬ë„ŒíŠ¸:**
```javascript
// ì´ìŠˆ ì¹´ë“œ ë Œë”ë§
const renderIssueCard = (issue) => {
    return `
        <div class="issue-card glassmorphism">
            <div class="category-badge ${getCategoryColor(issue.category)}">
                ${issue.category}
            </div>
            <h3>${issue.title}</h3>
            <div class="probability-gauge">
                <div class="gauge-bar">
                    <div class="gauge-fill" style="width: ${issue.probability.yes}%"></div>
                </div>
                <div class="probability-text">
                    Yes ${issue.probability.yes}% / No ${issue.probability.no}%
                </div>
            </div>
            <div class="betting-interface">
                <button class="bet-button yes" data-choice="Yes">
                    Yes ë² íŒ…
                </button>
                <button class="bet-button no" data-choice="No">
                    No ë² íŒ…
                </button>
            </div>
        </div>
    `;
};
```

#### ğŸ“ ì´ìŠˆ ìƒì„¸ í˜ì´ì§€
**í•µì‹¬ ê¸°ëŠ¥:**
- ì´ìŠˆ ìƒì„¸ ì •ë³´ ë° ì„¤ëª…
- ë² íŒ… ì¸í„°í˜ì´ìŠ¤ (ê¸ˆì•¡ ì…ë ¥)
- ì‹¤ì‹œê°„ ë² íŒ… í†µê³„
- ëŒ“ê¸€ ì‹œìŠ¤í…œ (ê³„ì¸µí˜• ëŒ“ê¸€ ì§€ì›)
- ì¢‹ì•„ìš”/ì‹«ì–´ìš” ì‹œìŠ¤í…œ

#### ğŸ‘¤ ë§ˆì´í˜ì´ì§€ (`mypage.html`)
**í•µì‹¬ ê¸°ëŠ¥:**
- ì‚¬ìš©ì í”„ë¡œí•„ ì •ë³´
- GAM ì”ì•¡ ë° ê±°ë˜ ë‚´ì—­
- ë‚´ ë² íŒ… í˜„í™© (ì§„í–‰ì¤‘/ì™„ë£Œ)
- ì˜ˆì¸¡ ì„±ê³µë¥  í†µê³„
- ì•Œë¦¼ ì„¤ì •

#### ğŸ” ë¡œê·¸ì¸/íšŒì›ê°€ì… (`login.html`)
**í•µì‹¬ ê¸°ëŠ¥:**
- ì‚¬ìš©ì ì¸ì¦ (ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸)
- íšŒì›ê°€ì… (ìœ íš¨ì„± ê²€ì¦)
- ì†Œì…œ ë¡œê·¸ì¸ ì¤€ë¹„ (êµ¬ê¸€, ê¹ƒí—ˆë¸Œ)

#### ğŸ› ï¸ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ (`admin.html`)
**í•µì‹¬ ê¸°ëŠ¥:**
- ì´ìŠˆ ê´€ë¦¬ (ìƒì„±, ìˆ˜ì •, ì‚­ì œ, ì •ì‚°)
- ì‚¬ìš©ì ê´€ë¦¬
- ëŒ“ê¸€ ê´€ë¦¬ (ìˆ¨ê¹€/ë³µì›)
- ì‹œìŠ¤í…œ í†µê³„
- ìŠ¤ì¼€ì¤„ëŸ¬ ê´€ë¦¬

### ğŸ¨ ë””ìì¸ ì‹œìŠ¤í…œ

#### ê¸€ë˜ìŠ¤ëª¨í”½ ìŠ¤íƒ€ì¼
```css
.glassmorphism {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.dark-glassmorphism {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
}
```

#### ì¹´í…Œê³ ë¦¬ ìƒ‰ìƒ ì‹œìŠ¤í…œ
```css
:root {
    --politics-gradient: linear-gradient(135deg, #EF4444, #F87171);
    --sports-gradient: linear-gradient(135deg, #06B6D4, #67E8F9);
    --economy-gradient: linear-gradient(135deg, #10B981, #34D399);
    --crypto-gradient: linear-gradient(135deg, #F59E0B, #FBBF24);
    --tech-gradient: linear-gradient(135deg, #8B5CF6, #A78BFA);
    --entertainment-gradient: linear-gradient(135deg, #EC4899, #F472B6);
    --weather-gradient: linear-gradient(135deg, #3B82F6, #60A5FA);
    --international-gradient: linear-gradient(135deg, #6366F1, #8B5CF6);
}
```

### ğŸ“± ë°˜ì‘í˜• ë””ìì¸
```css
/* Mobile First Approach */
.container {
    padding: 1rem;
}

/* Tablet */
@media (min-width: 768px) {
    .container {
        padding: 2rem;
        max-width: 768px;
        margin: 0 auto;
    }
}

/* Desktop */
@media (min-width: 1024px) {
    .container {
        max-width: 1200px;
        padding: 3rem;
    }
    
    .issue-grid {
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2rem;
    }
}
```

---

## ğŸ” ì¸ì¦ ë° ë³´ì•ˆ

### ğŸ”‘ ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ

#### JWT í† í° êµ¬ì¡°
```javascript
// JWT Payload
{
    "userId": 123,
    "username": "yegamer123",
    "iat": 1624567890,
    "exp": 1625172690,
    "iss": "yegam-app",
    "aud": "yegam-users"
}
```

#### ì¸ì¦ ë¯¸ë“¤ì›¨ì–´
```javascript
const authMiddleware = async (req, res, next) => {
    try {
        const token = req.headers.authorization?.split(' ')[1];
        if (!token) {
            return res.status(401).json({ 
                success: false, 
                message: 'ì¸ì¦ í† í°ì´ í•„ìš”í•©ë‹ˆë‹¤.' 
            });
        }
        
        const decoded = jwt.verify(token, JWT_SECRET);
        const user = await get('SELECT * FROM users WHERE id = $1', [decoded.userId]);
        
        if (!user) {
            return res.status(401).json({ 
                success: false, 
                message: 'ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ìì…ë‹ˆë‹¤.' 
            });
        }
        
        req.user = user;
        next();
    } catch (error) {
        res.status(401).json({ 
            success: false, 
            message: 'í† í° ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' 
        });
    }
};
```

### ğŸ›¡ï¸ ê´€ë¦¬ì ë³´ì•ˆ ì‹œìŠ¤í…œ

#### ì´ì¤‘ ì¸ì¦ êµ¬ì¡°
1. **ê´€ë¦¬ì ê³„ì • ë¶„ë¦¬**: ì¼ë°˜ ì‚¬ìš©ìì™€ ì™„ì „ ë¶„ë¦¬ëœ `admins` í…Œì´ë¸”
2. **ì„¸ì…˜ ê´€ë¦¬**: `admin_sessions` í…Œì´ë¸”ë¡œ í† í° ì¶”ì 
3. **í™œë™ ë¡œê·¸**: `admin_activity_logs`ë¡œ ëª¨ë“  ê´€ë¦¬ì í–‰ë™ ê¸°ë¡
4. **IP ì¶”ì **: ë¡œê·¸ì¸ IP ë° User-Agent ì €ì¥

#### ê´€ë¦¬ì ì¸ì¦ í”Œë¡œìš°
```mermaid
graph TD
    A[ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œë„] --> B[ê³„ì • ì¡´ì¬ í™•ì¸]
    B --> C[ë¹„ë°€ë²ˆí˜¸ ê²€ì¦]
    C --> D[JWT í† í° ìƒì„±]
    D --> E[ì„¸ì…˜ í…Œì´ë¸”ì— ê¸°ë¡]
    E --> F[í™œë™ ë¡œê·¸ ê¸°ë¡]
    F --> G[í´ë¼ì´ì–¸íŠ¸ì— í† í° ì „ì†¡]
    
    G --> H[API ìš”ì²­ì‹œ]
    H --> I[í† í° ê²€ì¦]
    I --> J[ì„¸ì…˜ ìœ íš¨ì„± í™•ì¸]
    J --> K[ê´€ë¦¬ì ê¶Œí•œ í™•ì¸]
    K --> L[ìš”ì²­ ì²˜ë¦¬]
    L --> M[í™œë™ ë¡œê·¸ ê¸°ë¡]
```

### ğŸš« ë³´ì•ˆ ëŒ€ì±…

#### Rate Limiting
```javascript
const loginAttempts = new Map();
const RATE_LIMIT_WINDOW = 15 * 60 * 1000; // 15ë¶„
const MAX_ATTEMPTS = 5;

const checkRateLimit = (identifier) => {
    const attemptData = loginAttempts.get(identifier) || { count: 0 };
    if (attemptData.count >= MAX_ATTEMPTS) {
        return { blocked: true, timeLeft: /* ê³„ì‚° */ };
    }
    return { blocked: false };
};
```

#### ì…ë ¥ê°’ ê²€ì¦
```javascript
const InputValidator = {
    validateEmail: (email) => {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    },
    
    validatePassword: (password) => {
        return password.length >= 8 && 
               /[A-Z]/.test(password) && 
               /[a-z]/.test(password) && 
               /[0-9]/.test(password);
    },
    
    sanitizeInput: (input) => {
        return input.trim().replace(/[<>\"']/g, '');
    }
};
```

#### SQL Injection ë°©ì§€
```javascript
// ëª¨ë“  ì¿¼ë¦¬ì—ì„œ íŒŒë¼ë¯¸í„°í™”ëœ ì¿¼ë¦¬ ì‚¬ìš©
const result = await query(
    'SELECT * FROM users WHERE email = $1 AND password_hash = $2',
    [email, hashedPassword]
);
```

---

## ğŸš€ ë°°í¬ ë° ìš´ì˜

### â˜ï¸ Railway ë°°í¬ êµ¬ì„±

#### `railway.toml` ì„¤ì •
```toml
[build]
builder = "nixpacks"

[deploy]
startCommand = "npm start"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "on_failure"

[environments.production.variables]
NODE_ENV = "production"
JWT_SECRET = "yegame-production-secret-key-2025-very-secure-random-string"
SESSION_SECRET = "yegame-session-secret-2025-very-secure-random-string"
```

#### í™˜ê²½ ë³€ìˆ˜
```bash
# í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜
DATABASE_URL=postgresql://username:password@host:port/database
JWT_SECRET=your-very-secure-secret-key
SESSION_SECRET=your-session-secret

# Cloudinary ì„¤ì •
CLOUDINARY_CLOUD_NAME=your-cloud-name
CLOUDINARY_API_KEY=your-api-key
CLOUDINARY_API_SECRET=your-api-secret

# ì„ íƒì  í™˜ê²½ ë³€ìˆ˜
NODE_ENV=production
PORT=3000
```

### ğŸ“Š Health Check ì‹œìŠ¤í…œ

#### ê¸°ë³¸ Health Check
```javascript
// GET /health
{
    "status": "healthy",
    "timestamp": "2025-06-22T10:30:00Z",
    "message": "Service is operational"
}
```

#### ìƒì„¸ Health Check
```javascript
// GET /health/detailed
{
    "status": "healthy",
    "timestamp": "2025-06-22T10:30:00Z",
    "responseTime": "45ms",
    "version": "1.0.0",
    "environment": "production",
    "checks": [
        {
            "name": "database",
            "status": "healthy",
            "responseTime": "12ms",
            "details": "PostgreSQL connection successful"
        },
        {
            "name": "memory",
            "status": "healthy",
            "details": {
                "used": "45.2 MB",
                "total": "512 MB",
                "percentage": "8.8%"
            }
        }
    ]
}
```

### âš™ï¸ ìë™í™” ìŠ¤ì¼€ì¤„ëŸ¬

#### ì´ìŠˆ ìë™ ë§ˆê° ì‹œìŠ¤í…œ
```javascript
const cron = require('node-cron');

// ë§¤ ì‹œê°„ë§ˆë‹¤ ë§Œë£Œëœ ì´ìŠˆ ê²€ì‚¬
cron.schedule('0 * * * *', async () => {
    console.log('ğŸ” ë§Œë£Œëœ ì´ìŠˆ ê²€ì‚¬ ì‹œì‘...');
    
    const expiredIssues = await query(`
        SELECT id, title 
        FROM issues 
        WHERE status = 'active' 
        AND end_date <= CURRENT_TIMESTAMP
    `);
    
    for (const issue of expiredIssues.rows) {
        await query(
            'UPDATE issues SET status = $1 WHERE id = $2',
            ['closed', issue.id]
        );
        
        console.log(`âœ… ì´ìŠˆ ë§ˆê°: ${issue.title}`);
    }
});
```

---

## ğŸ“š ê°œë°œ íˆìŠ¤í† ë¦¬

### ğŸ¯ Phase 1: ë°±ì—”ë“œ êµ¬ì¶• âœ…

#### í•µì‹¬ ì„±ì·¨
- **Node.js/Express ì„œë²„ êµ¬ì¶•**: RESTful API ì•„í‚¤í…ì²˜ ì„¤ê³„
- **PostgreSQL ë°ì´í„°ë² ì´ìŠ¤**: í™•ì¥ ê°€ëŠ¥í•œ ìŠ¤í‚¤ë§ˆ ì„¤ê³„
- **JWT ì¸ì¦ ì‹œìŠ¤í…œ**: ë³´ì•ˆì´ ê°•í™”ëœ ì‚¬ìš©ì ì¸ì¦
- **ë² íŒ… ì‹œìŠ¤í…œ**: ì‹¤ì‹œê°„ í™•ë¥  ê³„ì‚° ë° ì •ì‚° ë¡œì§
- **ëŒ“ê¸€ ì‹œìŠ¤í…œ**: ê³„ì¸µí˜• ëŒ“ê¸€ ë° ìƒí˜¸ì‘ìš© ê¸°ëŠ¥
- **GAM ê²½ì œ ì‹œìŠ¤í…œ**: ê°€ìƒ í™”í ê±°ë˜ ë‚´ì—­ ì¶”ì 

#### ì£¼ìš” ê¸°ìˆ ì  ê²°ì •
1. **PostgreSQL ì„ íƒ ì´ìœ **: SQLiteì—ì„œ ì—…ê·¸ë ˆì´ë“œ, ë™ì‹œì„± ë° í™•ì¥ì„± ê³ ë ¤
2. **JWT vs Session**: Stateless ì•„í‚¤í…ì²˜ë¡œ í™•ì¥ì„± í™•ë³´
3. **Cloudinary**: ì´ë¯¸ì§€ ì €ì¥ì†Œ ì™¸ë¶€í™”ë¡œ ì„œë²„ ë¶€í•˜ ê²½ê°
4. **Rate Limiting**: ë©”ëª¨ë¦¬ ê¸°ë°˜ ë‹¨ìˆœ êµ¬í˜„ (í–¥í›„ Redis ê³ ë ¤)

### ğŸŒ Phase 2: ë°°í¬ ë° ìš´ì˜ âœ…

#### ì¸í”„ë¼ êµ¬ì¶•
- **Railway í”Œë«í¼**: ê°„í¸í•œ ë°°í¬ ë° ê´€ë¦¬
- **PostgreSQL í´ë¼ìš°ë“œ**: Railway í†µí•© ë°ì´í„°ë² ì´ìŠ¤
- **Cloudinary CDN**: ì „ ì„¸ê³„ ì´ë¯¸ì§€ ìµœì í™” ë°°í¬
- **Health Check**: ì„œë¹„ìŠ¤ ìƒíƒœ ëª¨ë‹ˆí„°ë§

#### ë³´ì•ˆ ê°•í™”
- **ê´€ë¦¬ì ì‹œìŠ¤í…œ ë¶„ë¦¬**: ì´ì¤‘ ì¸ì¦ êµ¬ì¡° êµ¬í˜„
- **í™œë™ ë¡œê·¸**: ëª¨ë“  ê´€ë¦¬ì í–‰ë™ ì¶”ì 
- **ì…ë ¥ê°’ ê²€ì¦**: SQL Injection ë° XSS ë°©ì§€
- **Rate Limiting**: ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ë°©ì§€

### ğŸ”® Phase 3: ê³ ë„í™” (ì§„í–‰ ì˜ˆì •)

#### ì˜ˆì • ê¸°ëŠ¥
- **WebSocket ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: ë² íŒ… í˜„í™© ì¦‰ì‹œ ë°˜ì˜
- **Push ì•Œë¦¼**: ëª¨ë°”ì¼ ì•Œë¦¼ ì„œë¹„ìŠ¤
- **ê³ ê¸‰ í†µê³„**: ì‚¬ìš©ìë³„ ì„±ê³¼ ë¶„ì„
- **ëª¨ë°”ì¼ ì•±**: React Native ë˜ëŠ” PWA
- **ì†Œì…œ ê¸°ëŠ¥**: ì¹œêµ¬ ì‹œìŠ¤í…œ, ë¦¬ë”ë³´ë“œ

---

## ğŸ› ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ

### ğŸ”§ ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

#### 1. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
```bash
# ì¦ìƒ
Error: connect ECONNREFUSED 127.0.0.1:5432

# í•´ê²° ë°©ë²•
1. DATABASE_URL í™˜ê²½ ë³€ìˆ˜ í™•ì¸
2. PostgreSQL ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
3. ë°©í™”ë²½ ì„¤ì • í™•ì¸
4. Railway ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ í™•ì¸
```

#### 2. JWT í† í° ì—ëŸ¬
```bash
# ì¦ìƒ
JsonWebTokenError: invalid signature

# í•´ê²° ë°©ë²•
1. JWT_SECRET í™˜ê²½ ë³€ìˆ˜ í™•ì¸
2. í† í° ë§Œë£Œ ì‹œê°„ í™•ì¸
3. í´ë¼ì´ì–¸íŠ¸ í† í° ì €ì¥ ìƒíƒœ í™•ì¸
4. ì„œë²„ ì¬ì‹œì‘ (ë©”ëª¨ë¦¬ ì„¸ì…˜ ì´ˆê¸°í™”)
```

#### 3. Cloudinary ì—…ë¡œë“œ ì‹¤íŒ¨
```bash
# ì¦ìƒ
CloudinaryError: Must supply api_key

# í•´ê²° ë°©ë²•
1. Cloudinary í™˜ê²½ ë³€ìˆ˜ 3ê°œ ëª¨ë‘ ì„¤ì • í™•ì¸
2. API í‚¤ ìœ íš¨ì„± í™•ì¸
3. ì—…ë¡œë“œ ìš©ëŸ‰ ì œí•œ í™•ì¸
4. Cloudinary ê³„ì • ìƒíƒœ í™•ì¸
```

#### 4. ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹¤íŒ¨
```bash
# ì¦ìƒ
ê´€ë¦¬ì ì¸ì¦ ì‹¤íŒ¨

# í•´ê²° ë°©ë²•
1. /setup-admin ì—”ë“œí¬ì¸íŠ¸ë¡œ ê´€ë¦¬ì ê³„ì • ì¬ìƒì„±
2. admin_sessions í…Œì´ë¸” ì •ë¦¬
3. ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ í™•ì¸
4. ê´€ë¦¬ì í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ í™•ì¸
```

### ğŸ” ë””ë²„ê¹… ëª…ë ¹ì–´

#### ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ í™•ì¸
```bash
# Railway CLIë¡œ DB ì ‘ì†
railway connect postgres

# í…Œì´ë¸” ëª©ë¡ í™•ì¸
\dt

# ì‚¬ìš©ì ìˆ˜ í™•ì¸
SELECT COUNT(*) FROM users;

# í™œì„± ì´ìŠˆ ìˆ˜ í™•ì¸
SELECT COUNT(*) FROM issues WHERE status = 'active';
```

#### ë¡œê·¸ í™•ì¸
```bash
# Railway ë¡œê·¸ ì‹¤ì‹œê°„ í™•ì¸
railway logs --follow

# íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸
railway logs --since 1h
```

#### Health Check
```bash
# ê¸°ë³¸ ìƒíƒœ í™•ì¸
curl https://yegam-production.up.railway.app/health

# ìƒì„¸ ìƒíƒœ í™•ì¸
curl https://yegam-production.up.railway.app/health/detailed
```

### ğŸš¨ ì‘ê¸‰ ë³µêµ¬ ì ˆì°¨

#### 1. ì„œë¹„ìŠ¤ ì™„ì „ ì¤‘ë‹¨ ì‹œ
```bash
1. Railway ëŒ€ì‹œë³´ë“œì—ì„œ ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
2. ìµœê·¼ ë°°í¬ ë¡¤ë°± ê³ ë ¤
3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ìƒíƒœ í™•ì¸
4. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì¬í™•ì¸
5. ìˆ˜ë™ ì¬ì‹œì‘: railway restart
```

#### 2. ë°ì´í„° ì†ì‹¤ ìœ„í—˜ ì‹œ
```bash
1. ì¦‰ì‹œ Railwayì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ìƒì„±
2. ë¬¸ì œ ì›ì¸ íŒŒì•… ì „ê¹Œì§€ ì“°ê¸° ì‘ì—… ì¤‘ë‹¨
3. ë°±ì—…ì—ì„œ ë³µì› ì¤€ë¹„
4. ì‚¬ìš©ì ê³µì§€ì‚¬í•­ ê²Œì‹œ
```

#### 3. ë³´ì•ˆ ë¬¸ì œ ë°œê²¬ ì‹œ
```bash
1. ê´€ë ¨ ê¸°ëŠ¥ ì¦‰ì‹œ ë¹„í™œì„±í™”
2. ì‚¬ìš©ì ì„¸ì…˜ ê°•ì œ ë§Œë£Œ
3. ê´€ë¦¬ì ê³„ì • ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
4. ë¡œê·¸ ë¶„ì„ ë° ì˜í–¥ ë²”ìœ„ íŒŒì•…
5. íŒ¨ì¹˜ ì ìš© ë° ì¬ë°°í¬
```

---

## ğŸ“ ê°œë°œì Quick Start

### ğŸš€ ë¡œì»¬ ê°œë°œ í™˜ê²½ ì„¤ì • (5ë¶„ ê°€ì´ë“œ)

```bash
# 1. ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/ddoriboo/yegam.git
cd yegam

# 2. ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# 3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ í¸ì§‘í•˜ì—¬ DATABASE_URL, JWT_SECRET ë“± ì„¤ì •

# 4. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” (Railway PostgreSQL ê¶Œì¥)
npm run setup-db

# 5. ê´€ë¦¬ì ê³„ì • ìƒì„±
npm run create-admin

# 6. ê°œë°œ ì„œë²„ ì‹œì‘
npm run dev

# 7. ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸
open http://localhost:3000
```

### ğŸ”‘ í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜

```bash
# ë³µì‚¬í•´ì„œ .env íŒŒì¼ì— ë¶™ì—¬ë„£ê¸°
DATABASE_URL=postgresql://username:password@host:port/database
JWT_SECRET=your-super-secure-secret-key-here
SESSION_SECRET=your-session-secret-here
CLOUDINARY_CLOUD_NAME=your-cloudinary-name
CLOUDINARY_API_KEY=your-cloudinary-key
CLOUDINARY_API_SECRET=your-cloudinary-secret
NODE_ENV=development
PORT=3000
```

### ğŸ“‹ Claude Codeë¥¼ ìœ„í•œ í•µì‹¬ ì •ë³´

#### í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
- **ì–¸ì–´**: Node.js (Backend), Vanilla JavaScript (Frontend)
- **í”„ë ˆì„ì›Œí¬**: Express.js, Tailwind CSS
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL
- **ì¸ì¦**: JWT
- **ë°°í¬**: Railway
- **ì´ë¯¸ì§€**: Cloudinary

#### ì£¼ìš” íŒŒì¼ ìœ„ì¹˜
- **ì„œë²„ ì§„ì…ì **: `server.js`
- **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •**: `database/database.js`, `database/postgres.js`
- **API ë¼ìš°íŠ¸**: `routes/` ë””ë ‰í† ë¦¬
- **í”„ë¡ íŠ¸ì—”ë“œ ë¡œì§**: `js/app.js`
- **ìŠ¤íƒ€ì¼**: `css/style.css` (ì»¤ìŠ¤í…€), Tailwind CSS (í”„ë ˆì„ì›Œí¬)

#### ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ê´€ê³„
- `users` â†” `bets` (1:N)
- `issues` â†” `bets` (1:N)
- `users` â†” `comments` (1:N)
- `issues` â†” `comments` (1:N)
- `users` â†” `gam_transactions` (1:N)

#### í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- **ë² íŒ… ì‹œìŠ¤í…œ**: `routes/bets.js`
- **GAM ê²½ì œ**: `services/gamService.js`
- **ì´ìŠˆ ìŠ¤ì¼€ì¤„ëŸ¬**: `services/issueScheduler.js`
- **í™•ë¥  ê³„ì‚°**: ì‹¤ì‹œê°„ ë² íŒ… ë³¼ë¥¨ ê¸°ë°˜

#### ìì£¼ ìˆ˜ì •í•˜ëŠ” ë¶€ë¶„
- ìƒˆ API ì—”ë“œí¬ì¸íŠ¸: `routes/` ë””ë ‰í† ë¦¬
- í”„ë¡ íŠ¸ì—”ë“œ ê¸°ëŠ¥: `js/app.js`
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ: `database/postgres.js`
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§: `services/` ë””ë ‰í† ë¦¬

---

## ğŸ“ ì—°ë½ì²˜ ë° ì§€ì›

**GitHub Repository**: https://github.com/ddoriboo/yegam  
**Production URL**: https://yegam-production.up.railway.app/  
**Admin Panel**: https://yegam-production.up.railway.app/admin  

**ê¸°ìˆ  ë¬¸ì˜**: GitHub Issues ë¥¼ í†µí•´ ë¬¸ì˜í•´ ì£¼ì„¸ìš”.  
**ë²„ê·¸ ë¦¬í¬íŠ¸**: ìƒì„¸í•œ ì¬í˜„ ë‹¨ê³„ì™€ í•¨ê»˜ ì´ìŠˆ ë“±ë¡  
**ê¸°ëŠ¥ ì œì•ˆ**: Feature Request ë¼ë²¨ê³¼ í•¨ê»˜ ì´ìŠˆ ë“±ë¡  

---

*ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025ë…„ 6ì›” 22ì¼*  
*ë¬¸ì„œ ë²„ì „: v1.0*

**âš ï¸ ì¤‘ìš”**: ì´ ë¬¸ì„œëŠ” Yegam ì„œë¹„ìŠ¤ì˜ ì „ì²´ ê¸°ìˆ  ì‚¬ì–‘ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë³´ì•ˆì´ ì¤‘ìš”í•œ ë¶€ë¶„(JWT Secret, ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ë“±)ì€ ì ˆëŒ€ ê³µê°œí•˜ì§€ ë§ˆì„¸ìš”.