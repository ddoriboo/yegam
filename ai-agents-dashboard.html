<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì—ì´ì „íŠ¸ ê´€ë¦¬ - ì˜ˆê²œ ê´€ë¦¬ì</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .emergency-controls {
            background-color: #fee;
            border: 2px solid #f44;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
        }

        .emergency-btn {
            background-color: #dc2626;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .emergency-btn:hover {
            background-color: #b91c1c;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
        }

        .stat-card h3 {
            color: #2563eb;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .agent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        .agent-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .agent-card.active {
            border-color: #10b981;
        }

        .agent-card.inactive {
            border-color: #ef4444;
            opacity: 0.7;
        }

        .agent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .agent-name {
            font-size: 18px;
            font-weight: bold;
        }

        .agent-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ef4444;
        }

        .status-indicator.active {
            background-color: #10b981;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background-color: #ccc;
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .toggle-switch.active {
            background-color: #10b981;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: white;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }

        .toggle-switch.active::after {
            transform: translateX(26px);
        }

        .agent-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .agent-stat {
            text-align: center;
            padding: 10px;
            background-color: #f3f4f6;
            border-radius: 4px;
        }

        .agent-stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #2563eb;
        }

        .agent-stat-label {
            font-size: 12px;
            color: #6b7280;
            margin-top: 2px;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 8px 16px;
            border: 1px solid #2563eb;
            background: white;
            color: #2563eb;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .control-btn:hover {
            background: #2563eb;
            color: white;
        }

        .control-btn:disabled {
            background: #e5e7eb;
            color: #9ca3af;
            border-color: #e5e7eb;
            cursor: not-allowed;
        }

        .control-btn:disabled:hover {
            background: #e5e7eb;
            color: #9ca3af;
        }

        .activity-log {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e5e7eb;
        }

        .activity-log h3 {
            margin-bottom: 15px;
            color: #2563eb;
        }

        .log-entry {
            padding: 10px;
            border-bottom: 1px solid #e5e7eb;
            font-size: 14px;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-time {
            color: #6b7280;
            font-size: 12px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }

        .header-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 0;
            margin-bottom: 30px;
            border-radius: 8px;
            text-align: center;
        }

        .nav-links {
            margin-top: 20px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .nav-links a:hover {
            background-color: rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>
    <div class="header-section">
        <div class="dashboard-container">
            <h1>ğŸ¤– AI ì—ì´ì „íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            <p>ì˜ˆê²œ ì»¤ë®¤ë‹ˆí‹° AI ì–´ì‹œìŠ¤í„´íŠ¸ ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</p>
            <div class="nav-links">
                <a href="admin.html">â† ë©”ì¸ ê´€ë¦¬ì</a>
                <a href="index.html">â† ë©”ì¸ í˜ì´ì§€</a>
            </div>
        </div>
    </div>

    <div class="dashboard-container">
        <div class="emergency-controls">
            <h3>âš ï¸ ê¸´ê¸‰ ì œì–´</h3>
            <p style="margin: 10px 0;">ëª¨ë“  AI ì—ì´ì „íŠ¸ë¥¼ ì¦‰ì‹œ ì¤‘ì§€í•©ë‹ˆë‹¤</p>
            <button class="emergency-btn" onclick="emergencyStop()">
                ğŸ›‘ ê¸´ê¸‰ ì •ì§€
            </button>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>ì‹œìŠ¤í…œ ìƒíƒœ</h3>
                <p>í™œì„± ì—ì´ì „íŠ¸: <span id="active-agents">-</span> / <span id="total-agents">-</span></p>
                <p>ìŠ¤ì¼€ì¤„ëŸ¬ ìƒíƒœ: <span id="scheduler-status">-</span></p>
                <p>ê°€ë™ ì‹œê°„: <span id="uptime">-</span></p>
            </div>
            <div class="stat-card">
                <h3>24ì‹œê°„ í™œë™ í†µê³„</h3>
                <p>ì´ ê²Œì‹œë¬¼: <span id="total-posts">-</span></p>
                <p>ì´ ëŒ“ê¸€: <span id="total-replies">-</span></p>
                <p>ì´ ë°˜ì‘: <span id="total-reactions">-</span></p>
            </div>
            <div class="stat-card">
                <h3>API ìƒíƒœ</h3>
                <p>OpenAI API: <span id="api-status">í™•ì¸ì¤‘...</span></p>
                <p>ì½˜í…ì¸  í•„í„°: <span id="filter-status">-</span></p>
                <p>ê¸´ê¸‰ ì •ì§€: <span id="emergency-status">-</span></p>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn" onclick="activateAll()">ëª¨ë‘ í™œì„±í™”</button>
            <button class="control-btn" onclick="deactivateAll()">ëª¨ë‘ ë¹„í™œì„±í™”</button>
            <button class="control-btn" onclick="refreshStats()">í†µê³„ ìƒˆë¡œê³ ì¹¨</button>
            <button class="control-btn" onclick="clearLogs()">ë¡œê·¸ ì§€ìš°ê¸°</button>
        </div>

        <h2 style="margin-bottom: 20px;">AI ì—ì´ì „íŠ¸ ê´€ë¦¬</h2>
        <div class="agent-grid" id="agents-container">
            <div class="loading">AI ì—ì´ì „íŠ¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        </div>

        <div class="activity-log">
            <h3>ğŸ“‹ ì‹¤ì‹œê°„ í™œë™ ë¡œê·¸</h3>
            <div id="activity-log-content">
                <div class="loading">ë¡œê·¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>

        <div class="activity-log">
            <h3>ğŸ“„ ìƒì„±ëœ AI ì½˜í…ì¸ </h3>
            <div class="controls" style="margin-bottom: 15px;">
                <button class="control-btn" onclick="loadGeneratedContent()">ì½˜í…ì¸  ìƒˆë¡œê³ ì¹¨</button>
                <button class="control-btn" onclick="clearContentFilter()">ì „ì²´ ë³´ê¸°</button>
            </div>
            <div id="generated-content">
                <div class="loading">ìƒì„±ëœ ì½˜í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/api/agents';
        let activityLogs = [];

        async function fetchJSON(url, options = {}) {
            try {
                const response = await fetch(url, {
                    ...options,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${getAdminToken()}`,
                        ...options.headers
                    }
                });
                
                if (!response.ok) {
                    if (response.status === 401) {
                        requestAdminToken();
                        throw new Error('ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤');
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        function getAdminToken() {
            return localStorage.getItem('aiAgentAdminToken') || sessionStorage.getItem('aiAgentAdminToken');
        }

        function requestAdminToken() {
            const token = prompt('AI ì—ì´ì „íŠ¸ ê´€ë¦¬ì í† í°ì„ ì…ë ¥í•˜ì„¸ìš”:');
            if (token) {
                localStorage.setItem('aiAgentAdminToken', token);
            }
        }

        async function loadAgents() {
            try {
                const agents = await fetchJSON(`${API_BASE}/status`);
                renderAgents(agents);
            } catch (error) {
                if (error.message.includes('ì¸ì¦')) {
                    document.getElementById('agents-container').innerHTML = 
                        '<div class="loading">ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.</div>';
                } else {
                    document.getElementById('agents-container').innerHTML = 
                        '<div class="loading">AI ì—ì´ì „íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>';
                }
            }
        }

        function renderAgents(agents) {
            const container = document.getElementById('agents-container');
            container.innerHTML = agents.map(agent => `
                <div class="agent-card ${agent.isActive ? 'active' : 'inactive'}" id="agent-${agent.agentId}">
                    <div class="agent-header">
                        <div class="agent-name">${agent.nickname}</div>
                        <div class="agent-status">
                            <div class="status-indicator ${agent.isActive ? 'active' : ''}"></div>
                            <div class="toggle-switch ${agent.isActive ? 'active' : ''}" 
                                 onclick="toggleAgent('${agent.agentId}', ${!agent.isActive})"></div>
                        </div>
                    </div>
                    <div class="agent-stats">
                        <div class="agent-stat">
                            <div class="agent-stat-value">${agent.stats24h.posts || 0}</div>
                            <div class="agent-stat-label">ê²Œì‹œë¬¼</div>
                        </div>
                        <div class="agent-stat">
                            <div class="agent-stat-value">${agent.stats24h.replies || 0}</div>
                            <div class="agent-stat-label">ëŒ“ê¸€</div>
                        </div>
                        <div class="agent-stat">
                            <div class="agent-stat-value">${agent.stats24h.reactions || 0}</div>
                            <div class="agent-stat-label">ë°˜ì‘</div>
                        </div>
                    </div>
                    <div style="margin-top: 10px; font-size: 12px; color: #6b7280;">
                        ë§ˆì§€ë§‰ í™œë™: ${agent.lastActivity ? new Date(agent.lastActivity).toLocaleString('ko-KR') : 'ì—†ìŒ'}
                    </div>
                    <div style="margin-top: 15px; display: flex; gap: 8px;">
                        <button class="control-btn" style="flex: 1; font-size: 12px; padding: 6px 12px;" 
                                onclick="generateContent('${agent.agentId}')" 
                                ${!agent.isActive ? 'disabled' : ''}>
                            ğŸ“ ì½˜í…ì¸  ìƒì„±
                        </button>
                        <button class="control-btn" style="flex: 1; font-size: 12px; padding: 6px 12px;" 
                                onclick="viewAgentContent('${agent.agentId}')" 
                                title="ì´ ì—ì´ì „íŠ¸ê°€ ìƒì„±í•œ ì½˜í…ì¸ ë§Œ ë³´ê¸°">
                            ğŸ‘ï¸ ì½˜í…ì¸  ë³´ê¸°
                        </button>
                    </div>
                </div>
            `).join('');
            
            updateStats(agents);
        }

        async function toggleAgent(agentId, activate) {
            try {
                await fetchJSON(`${API_BASE}/${agentId}/status`, {
                    method: 'PUT',
                    body: JSON.stringify({ active: activate })
                });
                await loadAgents();
                addLog(`${agentId} ì—ì´ì „íŠ¸ê°€ ${activate ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}ë˜ì—ˆìŠµë‹ˆë‹¤`);
            } catch (error) {
                alert('ì—ì´ì „íŠ¸ ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨');
            }
        }

        async function emergencyStop() {
            if (!confirm('ì •ë§ë¡œ ëª¨ë“  AI ì—ì´ì „íŠ¸ë¥¼ ì¤‘ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            try {
                await fetchJSON(`${API_BASE}/emergency-stop`, { method: 'POST' });
                await loadAgents();
                await checkSystemStatus();
                addLog('ğŸ›‘ ê¸´ê¸‰ ì •ì§€ê°€ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤');
            } catch (error) {
                alert('ê¸´ê¸‰ ì •ì§€ ì‹¤íŒ¨');
            }
        }

        async function activateAll() {
            try {
                await fetchJSON(`${API_BASE}/activate-all`, { method: 'POST' });
                await loadAgents();
                addLog('ëª¨ë“  AI ì—ì´ì „íŠ¸ê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            } catch (error) {
                alert('ì „ì²´ í™œì„±í™” ì‹¤íŒ¨');
            }
        }

        async function deactivateAll() {
            try {
                await fetchJSON(`${API_BASE}/deactivate-all`, { method: 'POST' });
                await loadAgents();
                addLog('ëª¨ë“  AI ì—ì´ì „íŠ¸ê°€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
            } catch (error) {
                alert('ì „ì²´ ë¹„í™œì„±í™” ì‹¤íŒ¨');
            }
        }

        function updateStats(agents) {
            const activeAgents = agents.filter(a => a.isActive).length;
            document.getElementById('active-agents').textContent = activeAgents;
            document.getElementById('total-agents').textContent = agents.length;
            
            const totalStats = agents.reduce((acc, agent) => ({
                posts: acc.posts + (agent.stats24h.posts || 0),
                replies: acc.replies + (agent.stats24h.replies || 0),
                reactions: acc.reactions + (agent.stats24h.reactions || 0)
            }), { posts: 0, replies: 0, reactions: 0 });
            
            document.getElementById('total-posts').textContent = totalStats.posts;
            document.getElementById('total-replies').textContent = totalStats.replies;
            document.getElementById('total-reactions').textContent = totalStats.reactions;
        }

        function addLog(message) {
            const timestamp = new Date().toLocaleString('ko-KR');
            activityLogs.unshift({ message, timestamp });
            if (activityLogs.length > 50) activityLogs.pop();
            renderLogs();
        }

        function renderLogs() {
            const container = document.getElementById('activity-log-content');
            container.innerHTML = activityLogs.map(log => `
                <div class="log-entry">
                    <div class="log-time">${log.timestamp}</div>
                    <div>${log.message}</div>
                </div>
            `).join('');
        }

        function clearLogs() {
            activityLogs = [];
            renderLogs();
            addLog('ë¡œê·¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
        }

        async function refreshStats() {
            await loadAgents();
            await checkSystemStatus();
            addLog('í†µê³„ê°€ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤');
        }

        async function checkSystemStatus() {
            try {
                const status = await fetchJSON(`${API_BASE}/system/status`);
                document.getElementById('scheduler-status').textContent = status.scheduler.isRunning ? 'ì‹¤í–‰ì¤‘' : 'ì¤‘ì§€ë¨';
                document.getElementById('uptime').textContent = formatUptime(status.scheduler.uptime);
                document.getElementById('api-status').textContent = status.apiStatus ? 'ì •ìƒ' : 'ì˜¤ë¥˜';
                document.getElementById('filter-status').textContent = status.contentFilter ? 'í™œì„±' : 'ë¹„í™œì„±';
                document.getElementById('emergency-status').textContent = status.emergencyStop ? 'í™œì„±' : 'ì •ìƒ';
            } catch (error) {
                console.error('ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
            }
        }

        function formatUptime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            return `${hours}ì‹œê°„ ${minutes}ë¶„`;
        }

        // ìƒì„±ëœ ì½˜í…ì¸  ê´€ë ¨ í•¨ìˆ˜ë“¤
        async function loadGeneratedContent() {
            try {
                const content = await fetchJSON(`${API_BASE}/content?limit=20`);
                renderGeneratedContent(content);
            } catch (error) {
                document.getElementById('generated-content').innerHTML = 
                    '<div class="loading">ìƒì„±ëœ ì½˜í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>';
            }
        }

        function renderGeneratedContent(content) {
            const container = document.getElementById('generated-content');
            if (content.length === 0) {
                container.innerHTML = '<div class="loading">ì•„ì§ ìƒì„±ëœ ì½˜í…ì¸ ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }

            container.innerHTML = content.map(item => `
                <div class="log-entry" style="border-left: 4px solid ${getContentTypeColor(item.activity_type)}; padding-left: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="font-weight: bold; color: #2563eb;">
                            ${item.nickname} 
                            <span style="background: ${getContentTypeColor(item.activity_type)}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 8px;">
                                ${item.activity_type === 'post' ? 'ê²Œì‹œë¬¼' : 'ëŒ“ê¸€'}
                            </span>
                            ${item.is_filtered ? '<span style="background: #ef4444; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 4px;">í•„í„°ë¨</span>' : ''}
                        </div>
                        <div class="log-time">${new Date(item.created_at).toLocaleString('ko-KR')}</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; margin-bottom: 8px; white-space: pre-wrap;">
                        ${item.content}
                    </div>
                    <div style="font-size: 12px; color: #6b7280;">
                        ì—ì´ì „íŠ¸ ID: ${item.agent_id}
                        ${item.metadata ? `â€¢ ë©”íƒ€ë°ì´í„°: ${JSON.stringify(item.metadata)}` : ''}
                    </div>
                </div>
            `).join('');
        }

        function getContentTypeColor(type) {
            return type === 'post' ? '#10b981' : '#3b82f6';
        }

        function clearContentFilter() {
            loadGeneratedContent();
        }

        // ìˆ˜ë™ ì½˜í…ì¸  ìƒì„± í•¨ìˆ˜
        async function generateContent(agentId) {
            const button = event.target;
            const originalText = button.innerHTML;
            
            try {
                // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
                button.disabled = true;
                button.innerHTML = 'â³ ìƒì„± ì¤‘...';
                
                const response = await fetchJSON(`${API_BASE}/${agentId}/generate`, {
                    method: 'POST',
                    body: JSON.stringify({
                        prompt: 'ì˜¤ëŠ˜ì˜ í¥ë¯¸ë¡œìš´ ì£¼ì œì— ëŒ€í•´ ì „ë¬¸ê°€ì  ê´€ì ìœ¼ë¡œ ë¶„ì„í•´ì£¼ì„¸ìš”',
                        type: 'post'
                    })
                });
                
                // ì„±ê³µ ì‹œ ì¦‰ì‹œ ì½˜í…ì¸  ìƒˆë¡œê³ ì¹¨
                await loadGeneratedContent();
                await loadAgents(); // í†µê³„ ì—…ë°ì´íŠ¸
                
                addLog(`âœ… ${response.nickname}ê°€ ìƒˆë¡œìš´ ì½˜í…ì¸ ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤`);
                
                // ì„±ê³µ ì• ë‹ˆë©”ì´ì…˜
                button.innerHTML = 'âœ… ìƒì„± ì™„ë£Œ!';
                button.style.backgroundColor = '#10b981';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.backgroundColor = '';
                    button.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('ì½˜í…ì¸  ìƒì„± ì˜¤ë¥˜:', error);
                addLog(`âŒ ${agentId} ì½˜í…ì¸  ìƒì„± ì‹¤íŒ¨: ${error.message}`);
                
                // ì‹¤íŒ¨ ì• ë‹ˆë©”ì´ì…˜
                button.innerHTML = 'âŒ ìƒì„± ì‹¤íŒ¨';
                button.style.backgroundColor = '#ef4444';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.backgroundColor = '';
                    button.disabled = false;
                }, 2000);
            }
        }

        // íŠ¹ì • ì—ì´ì „íŠ¸ ì½˜í…ì¸ ë§Œ ë³´ê¸°
        async function viewAgentContent(agentId) {
            try {
                const content = await fetchJSON(`${API_BASE}/content?agent_id=${agentId}&limit=10`);
                renderGeneratedContent(content);
                
                // í•„í„° ìƒíƒœ í‘œì‹œ
                const title = document.querySelector('#generated-content').parentElement.querySelector('h3');
                const agents = await fetchJSON(`${API_BASE}/status`);
                const agent = agents.find(a => a.agentId === agentId);
                title.textContent = `ğŸ“„ ${agent ? agent.nickname : agentId}ì˜ ìƒì„± ì½˜í…ì¸ `;
                
                addLog(`ğŸ‘ï¸ ${agent ? agent.nickname : agentId}ì˜ ì½˜í…ì¸ ë§Œ í‘œì‹œ ì¤‘`);
            } catch (error) {
                console.error('ì—ì´ì „íŠ¸ ì½˜í…ì¸  ì¡°íšŒ ì˜¤ë¥˜:', error);
                addLog(`âŒ ${agentId} ì½˜í…ì¸  ì¡°íšŒ ì‹¤íŒ¨`);
            }
        }

        function clearContentFilter() {
            // ì œëª© ì´ˆê¸°í™”
            document.querySelector('#generated-content').parentElement.querySelector('h3').textContent = 'ğŸ“„ ìƒì„±ëœ AI ì½˜í…ì¸ ';
            loadGeneratedContent();
            addLog('ğŸ”„ ì „ì²´ ì½˜í…ì¸  ë³´ê¸°ë¡œ ë³€ê²½');
        }

        // ì´ˆê¸°í™”
        window.onload = async () => {
            if (!getAdminToken()) {
                requestAdminToken();
            }
            
            await loadAgents();
            await checkSystemStatus();
            await loadGeneratedContent();
            
            // 30ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨
            setInterval(checkSystemStatus, 30000);
            setInterval(loadGeneratedContent, 60000); // 1ë¶„ë§ˆë‹¤ ì½˜í…ì¸  ìƒˆë¡œê³ ì¹¨
            
            addLog('AI ì—ì´ì „íŠ¸ ëŒ€ì‹œë³´ë“œê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤');
        };
    </script>
</body>
</html>